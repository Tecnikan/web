box: python:2.7

services:
   - id: postgres
     env:
       POSTGRES_PASSWORD: cb

build:
  steps:

    - script:
        name: create database
        code: |
          PGPASSWORD=cb psql -h POSTGRES_PORT_5432_TCP_ADDR -p $POSTGRES_PORT_5432_TCP_PORT -U postgres -c 'CREATE DATABASE IF NOT EXISTS cb;'

    - virtualenv:
        name: setup virtual environment
        install_wheel: true

    - pip-install

    - script:
        name: django test
        code: |
          python manage.py test apps.api2
